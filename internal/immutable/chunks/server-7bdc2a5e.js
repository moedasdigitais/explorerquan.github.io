import{w as h}from"./index-08e0cf00.js";const u={hash:0,height:0,timestamp:0,major_version:0,minor_version:0,difficulty:0,blockSize:0,transactionsCumulativeSize:0,transactions:[],fromSearch:!1},{subscribe:m,update:l}=h(u),c=(r,s)=>{if(r===0)return"0 Bytes";const e=1024,t=s||2,o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(r)/Math.log(e));return parseFloat((r/Math.pow(e,n)).toFixed(t))+" "+o[n]},p=r=>{if(r)l(s=>{if(r.hash)for(let e=r.transactions.length-1;e>=0;e--){const t=r.transactions[e];t&&(t.size&&(r.transactions[e].size=c(t.size)),t.amount_out&&(r.transactions[e].amount_out=(parseInt(t.amount_out)/1e8).toFixed(8))),e===0&&(s.hash=r.hash,s.height=r.height,s.timestamp=r.timestamp,s.major_version=r.major_version,s.minor_version=r.minor_version,s.difficulty=r.difficulty,s.blockSize=c(r.blockSize),s.transactionsCumulativeSize=r.transactionsCumulativeSize,s.transactions=r.transactions)}return r.fromSearch?r.fromSearch&&(s.fromSearch=!0):s.fromSearch=!1,s});else return u},_={subscribe:m,setData:p},a=[],{subscribe:f,update:v}=h(a),g=(r,s)=>r&&s?new Promise(e=>{f(async t=>{if(t.length>0){const o=t[0]+""+r,n=await fetch(o,s).then(i=>i.json()).catch(i=>i&&i.response&&i.response.status?{error:i.response.status}:{error:"fecth data error"});if(n)return n.height||n.result?n.result?e({res:n.result}):e({res:n}):e({error:"no result"})}else return e({error:"no server to request"})})}):{error:"needs: url and config object"},B=async r=>{if(a.length===0){const s=await fetch(r,{method:"GET"}).then(e=>e.json());s&&s.length>0&&v(e=>(e=[...s],e))}else return a},y={subscribe:f,init:B,requestJson:g};export{_ as b,y as s};
